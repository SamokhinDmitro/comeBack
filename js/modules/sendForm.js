class SendForm{constructor(){let e=this.info=document.createElement("div");this.glob=this;e.classList.add("warning");this.message={loading:"Загрузка...",success:"Спасибо! Скоро мы с вами свяжемся",error:"Что-то пошло не так",phone:"Введите телефон!"}}processForm(e){for(let t=0;t<e.elements.length;t++)"submit"!==e.elements[t].type&&(e.elements[t].setAttribute("required","required"),e.elements[t].addEventListener("blur",e=>(new Validation).validateForm(e)));e.elements.message&&(e.elements.message.removeAttribute("required"),e.elements.message.addEventListener("input",e=>this.textAreaEdit(e))),e.addEventListener("submit",e=>this.sendForm(e))}textAreaEdit(e){const t=e.target,{value:n}=t;n.length<=50&&(t.maxLength=50,this.info.innerText=`Осталось символов: ${50-n.length}`,t.parentElement.insertBefore(this.info,t.nextElementSibling))}sendForm(e){e.preventDefault();let t=e.target;const n=this.message;let s=document.createElement("div");s.classList.add("form__message");let r={};for(let e in t.elements)t.elements.hasOwnProperty(e)&&t.elements[e].name&&(r[t.elements[e].name]=t.elements[e].value);let a=new XMLHttpRequest;a.open("POST","https://lit-journey-63976.herokuapp.com/clients"),a.setRequestHeader("Content-type","application/json; charset = utf-8"),a.send(JSON.stringify(r)),t.append(s),a.addEventListener("readystatechange",function(){a.readyState<4?s.textContent=n.loading:4===a.readyState&&200===a.status?s.textContent=a.response:s.textContent=n.error}),setTimeout(()=>{t.removeChild(s)},5e3),this.clearForm(t)}clearForm(e){for(let t=0;t<e.elements.length;t++)e.elements[t].value="",e.elements[t].style.border="1px solid transparent"}}